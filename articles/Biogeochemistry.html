<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>6. Biogeochemistry • planktonr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="6. Biogeochemistry">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">planktonr</a>
        <span class="version label label-info" data-toggle="tooltip" data-placement="bottom" title="">0.5.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/planktonr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/EssentialOceanVariables.html">1. Essential Ocean Variables</a>
    </li>
    <li>
      <a href="../articles/Microbes.html">2. Microbes</a>
    </li>
    <li>
      <a href="../articles/Phytoplankton.html">3. Phytoplankton</a>
    </li>
    <li>
      <a href="../articles/Zooplankton.html">4. Zooplankton</a>
    </li>
    <li>
      <a href="../articles/LarvalFish.html">5. LarvalFish</a>
    </li>
    <li>
      <a href="../articles/Biogeochemistry.html">6. Biogeochemistry</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/PlanktonTeam/planktonr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>6. Biogeochemistry</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/PlanktonTeam/planktonr/blob/main/vignettes/Biogeochemistry.Rmd" class="external-link"><code>vignettes/Biogeochemistry.Rmd</code></a></small>
      <div class="hidden name"><code>Biogeochemistry.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/PlanktonTeam/planktonr" class="external-link">planktonr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="nutrients-at-national-reference-stations">Nutrients at National Reference Stations<a class="anchor" aria-label="anchor" href="#nutrients-at-national-reference-stations"></a>
</h4>
<p>Explore the data and see what parameters are available for plotting
at which stations. Note that Oxygen data is only available for Maria
Island and Rottnest Island.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Nuts</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pr_get_NRSEnvContour.html">pr_get_NRSEnvContour</a></span><span class="op">(</span><span class="st">"Chemistry"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">Nuts</span><span class="op">$</span><span class="va">Parameters</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "Silicate_umolL"    "Phosphate_umolL"   "Ammonium_umolL"   </span></span>
<span><span class="co">#&gt;  [4] "Nitrate_umolL"     "DIC_umolkg"        "Alkalinity_umolkg"</span></span>
<span><span class="co">#&gt;  [7] "Salinity"          "NOx_umolL"         "DIN_umolL"        </span></span>
<span><span class="co">#&gt; [10] "Redfield"          "Nitrite_umolL"     "Oxygen_umolL"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">Nuts</span><span class="op">$</span><span class="va">StationName</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] Darwin                  Esperance               Kangaroo Island        </span></span>
<span><span class="co">#&gt; [4] Maria Island            Ningaloo                North Stradbroke Island</span></span>
<span><span class="co">#&gt; [7] Port Hacking            Rottnest Island         Yongala                </span></span>
<span><span class="co">#&gt; 10 Levels: Darwin Yongala Ningaloo North Stradbroke Island ... Maria Island</span></span></code></pre></div>
<p>Here we use a contour plot to visualise Nitrate at the east coast
stations. This function can be used with raw data, interpolated data and
with gap filled interpolated data. The maxgap attribute in only valid
when Fill_NA is true. The highest nitrate levels occur at depth in Port
Hacking and can be seen to be lowest in the winter months.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Nuts</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pr_get_NRSEnvContour.html">pr_get_NRSEnvContour</a></span><span class="op">(</span><span class="st">"Chemistry"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">StationCode</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NSI"</span>, <span class="st">"PHB"</span>, <span class="st">"MAI"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Parameters</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="st">"Nitrate_umolL"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">.data</span><span class="op">$</span><span class="va">Parameters</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="co"># TODO Check</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html" class="external-link">drop_na</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/pr_plot_NRSEnvContour.html">pr_plot_NRSEnvContour</a></span><span class="op">(</span><span class="va">Nuts</span>, Interpolation <span class="op">=</span> <span class="cn">TRUE</span>, Fill_NA <span class="op">=</span> <span class="cn">TRUE</span>, maxGap <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="Biogeochemistry_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
</div>
<div class="section level4">
<h4 id="ctd-data-from-national-reference-stations">CTD data from National Reference Stations<a class="anchor" aria-label="anchor" href="#ctd-data-from-national-reference-stations"></a>
</h4>
<p>Using “W” in the pr_get_Indices function will get the parameters
associated with the water body at the time of sampling. The parameters
starting CTD are mean values over the top 10m of the water column.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CTD</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pr_get_Indices.html">pr_get_Indices</a></span><span class="op">(</span><span class="st">"NRS"</span>, <span class="st">"W"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">CTD</span><span class="op">$</span><span class="va">Parameters</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Secchi_m"            "MLDtemp_m"           "MLDsal_m"           </span></span>
<span><span class="co">#&gt; [4] "DCM_m"               "CTDTemperature_degC" "CTDSalinity_PSU"    </span></span>
<span><span class="co">#&gt; [7] "CTDChlaF_mgm3"</span></span></code></pre></div>
<p>As you would expect if we plot the surface temperature at North
Stradbroke it is significantly warmer than that at Maria Island. Both
seem reasonably stable over the plotting period with very similar
seasonal trends.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">CTD</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pr_get_Indices.html">pr_get_Indices</a></span><span class="op">(</span><span class="st">"NRS"</span>, <span class="st">"W"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Parameters</span> <span class="op">==</span> <span class="st">"CTDTemperature_degC"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">StationCode</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NSI"</span>, <span class="st">"MAI"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pr_plot_Trends.html">pr_plot_Trends</a></span><span class="op">(</span><span class="va">CTD</span>, Trend <span class="op">=</span> <span class="st">"Raw"</span>, Survey <span class="op">=</span> <span class="st">"NRS"</span>, method <span class="op">=</span> <span class="st">"lm"</span>, trans <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pr_plot_Trends.html">pr_plot_Trends</a></span><span class="op">(</span><span class="va">CTD</span>, Trend <span class="op">=</span> <span class="st">"Month"</span>, Survey <span class="op">=</span> <span class="st">"NRS"</span>, method <span class="op">=</span> <span class="st">"loess"</span>, trans <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.title.y <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p1</span> <span class="op">+</span> <span class="va">p2</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">plot_layout</a></span><span class="op">(</span>widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span>, guides <span class="op">=</span> <span class="st">"collect"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Biogeochemistry_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="pigments-at-national-reference-stations">Pigments at National Reference Stations<a class="anchor" aria-label="anchor" href="#pigments-at-national-reference-stations"></a>
</h2>
<p>The pigments are available as binned or raw. The binned version
provides the data as Totals of the major pigment components, the raw
data is the values of the individual pigments measured. The collection
of pigments has varied over the course of the sampling program, the
surface and 20m samples are the most consistently sampled. You may want
to round the depths for a neater plot.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Pigs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pr_get_NRSPigments.html">pr_get_NRSPigments</a></span><span class="op">(</span>Format <span class="op">=</span> <span class="st">"binned"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/pr_remove_outliers.html">pr_remove_outliers</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Parameters</span> <span class="op">==</span> <span class="st">"TotalChla"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">StationCode</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NSI"</span>, <span class="st">"MAI"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="op">(</span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pr_plot_Enviro.html">pr_plot_Enviro</a></span><span class="op">(</span><span class="va">Pigs</span>, Trend <span class="op">=</span> <span class="st">"Smoother"</span>, trans <span class="op">=</span> <span class="st">"log10"</span><span class="op">)</span> <span class="op">&amp;</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Biogeochemistry_files/figure-html/unnamed-chunk-6-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="picophytoplankton-at-national-reference-stations">Picophytoplankton at National Reference Stations<a class="anchor" aria-label="anchor" href="#picophytoplankton-at-national-reference-stations"></a>
</h2>
<p>The contour plots are a neat way to visualise the picoplankton from
the NRS stations. The data can be viewed as raw, interpolated or
interpolated with gap filling.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Pico</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pr_get_NRSEnvContour.html">pr_get_NRSEnvContour</a></span><span class="op">(</span><span class="st">"Pico"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Parameters</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Prochlorococcus_cellsmL"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">StationCode</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PHB"</span>, <span class="st">"MAI"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/pr_plot_NRSEnvContour.html">pr_plot_NRSEnvContour</a></span><span class="op">(</span><span class="va">Pico</span>, Interpolation <span class="op">=</span> <span class="cn">TRUE</span>, Fill_NA <span class="op">=</span> <span class="cn">TRUE</span>, maxGap <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="Biogeochemistry_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jason D. Everett, Claire H. Davies.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
