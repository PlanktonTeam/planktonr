<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Plot environmental data with depth profiles — pr_plot_Enviro • planktonr</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Plot environmental data with depth profiles — pr_plot_Enviro"><meta property="og:description" content="Create a two-panel figure showing environmental variables (nutrients, pigments,
picophytoplankton) as both time series and climatology plots, with separate lines
for different sampling depths. This is useful for visualising vertical structure
and temporal patterns in water column properties."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">planktonr</a>
        <span class="version label label-info" data-toggle="tooltip" data-placement="bottom" title="">0.6.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/planktonr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/EssentialOceanVariables.html">1. Essential Ocean Variables</a>
    </li>
    <li>
      <a href="../articles/Microbes.html">2. Microbes</a>
    </li>
    <li>
      <a href="../articles/Phytoplankton.html">3. Phytoplankton</a>
    </li>
    <li>
      <a href="../articles/Zooplankton.html">4. Zooplankton</a>
    </li>
    <li>
      <a href="../articles/LarvalFish.html">5. LarvalFish</a>
    </li>
    <li>
      <a href="../articles/Biogeochemistry.html">6. Biogeochemistry</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/PlanktonTeam/planktonr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plot environmental data with depth profiles</h1>
    <small class="dont-index">Source: <a href="https://github.com/PlanktonTeam/planktonr/blob/HEAD/R/plot_enviro.R" class="external-link"><code>R/plot_enviro.R</code></a></small>
    <div class="hidden name"><code>pr_plot_Enviro.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Create a two-panel figure showing environmental variables (nutrients, pigments,
picophytoplankton) as both time series and climatology plots, with separate lines
for different sampling depths. This is useful for visualising vertical structure
and temporal patterns in water column properties.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">pr_plot_Enviro</span><span class="op">(</span><span class="va">df</span>, Trend <span class="op">=</span> <span class="st">"None"</span>, trans <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-df">df<a class="anchor" aria-label="anchor" href="#arg-df"></a></dt>
<dd><p>A dataframe from <code><a href="pr_get_NRSChemistry.html">pr_get_NRSChemistry()</a></code>, <code><a href="pr_get_NRSPigments.html">pr_get_NRSPigments()</a></code>,
or <code><a href="pr_get_NRSPico.html">pr_get_NRSPico()</a></code> containing environmental data with depth information</p></dd>


<dt id="arg-trend">Trend<a class="anchor" aria-label="anchor" href="#arg-trend"></a></dt>
<dd><p>Type of trend line to add:</p><ul><li><p><code>"None"</code> - No trend line</p></li>
<li><p><code>"Smoother"</code> - LOESS smooth (default, good for non-linear patterns)</p></li>
<li><p><code>"Linear"</code> - Linear regression line</p></li>
</ul></dd>


<dt id="arg-trans">trans<a class="anchor" aria-label="anchor" href="#arg-trans"></a></dt>
<dd><p>Transformation for the y-axis scale:</p><ul><li><p><code>"identity"</code> - No transformation (default)</p></li>
<li><p><code>"log10"</code> - Log base 10 transformation (useful for pigments, nutrients)</p></li>
<li><p><code>"sqrt"</code> - Square root transformation</p></li>
<li><p>Any other transformation accepted by <code><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">ggplot2::scale_y_continuous()</a></code></p></li>
</ul></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A patchwork object containing two ggplot2 panels side-by-side</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This function creates a two-panel figure:</p><div class="section">
<h3 id="panel-time-series-left-wider-">Panel 1: Time Series (left, wider)<a class="anchor" aria-label="anchor" href="#panel-time-series-left-wider-"></a></h3>


<p>Shows the full time series with different colours/line types for each depth.
Useful for identifying:</p><ul><li><p>Long-term trends at different depths</p></li>
<li><p>Episodic events (e.g., upwelling, mixing)</p></li>
<li><p>Vertical stratification patterns</p></li>
<li><p>Deep chlorophyll maximum dynamics</p></li>
</ul></div>

<div class="section">
<h3 id="panel-monthly-climatology-right-narrower-">Panel 2: Monthly Climatology (right, narrower)<a class="anchor" aria-label="anchor" href="#panel-monthly-climatology-right-narrower-"></a></h3>


<p>Shows the mean seasonal cycle at each depth. Useful for identifying:</p><ul><li><p>Typical seasonal patterns (e.g., spring bloom, summer stratification)</p></li>
<li><p>Depth of maximum values by season</p></li>
<li><p>Seasonal vertical migration of features</p></li>
</ul><p>The function automatically rounds depth values and creates appropriate legends.
Use <code><a href="pr_remove_outliers.html">pr_remove_outliers()</a></code> before plotting if extreme values are present.</p>
</div>

    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="pr_get_NRSChemistry.html">pr_get_NRSChemistry()</a></code> for nutrient data,
<code><a href="pr_get_NRSPigments.html">pr_get_NRSPigments()</a></code> for pigment data,
<code><a href="pr_get_NRSPico.html">pr_get_NRSPico()</a></code> for picophytoplankton data,
<code><a href="pr_plot_NRSEnvContour.html">pr_plot_NRSEnvContour()</a></code> for contour plot visualisation</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Plot total chlorophyll a with depth</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="pr_get_NRSPigments.html">pr_get_NRSPigments</a></span><span class="op">(</span>Format <span class="op">=</span> <span class="st">"binned"</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="pr_remove_outliers.html">pr_remove_outliers</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Parameters</span> <span class="op">==</span> <span class="st">"TotalChla"</span>,</span></span>
<span class="r-in"><span>                <span class="va">StationCode</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NSI"</span>, <span class="st">"MAI"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">pr_plot_Enviro</span><span class="op">(</span><span class="va">df</span>, Trend <span class="op">=</span> <span class="st">"Smoother"</span>, trans <span class="op">=</span> <span class="st">"log10"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>no non-missing arguments to max; returning -Inf</span>
<span class="r-plt img"><img src="pr_plot_Enviro-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot nitrate concentrations</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="pr_get_NRSChemistry.html">pr_get_NRSChemistry</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Parameters</span> <span class="op">==</span> <span class="st">"Nitrate_umolL"</span>,</span></span>
<span class="r-in"><span>                <span class="va">StationCode</span> <span class="op">==</span> <span class="st">"PHB"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">pr_plot_Enviro</span><span class="op">(</span><span class="va">df</span>, Trend <span class="op">=</span> <span class="st">"Linear"</span>, trans <span class="op">=</span> <span class="st">"identity"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 42 rows containing non-finite outside the scale range</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> (`stat_smooth()`).</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 1 row containing missing values or values outside the scale range</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> (`geom_line()`).</span>
<span class="r-plt img"><img src="pr_plot_Enviro-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot Prochlorococcus abundance</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="pr_get_NRSPico.html">pr_get_NRSPico</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Parameters</span> <span class="op">==</span> <span class="st">"Prochlorococcus_cellsmL"</span>,</span></span>
<span class="r-in"><span>                <span class="va">StationCode</span> <span class="op">==</span> <span class="st">"NSI"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">pr_plot_Enviro</span><span class="op">(</span><span class="va">df</span>, Trend <span class="op">=</span> <span class="st">"Smoother"</span>, trans <span class="op">=</span> <span class="st">"log10"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 1 row containing non-finite outside the scale range (`stat_smooth()`).</span>
<span class="r-plt img"><img src="pr_plot_Enviro-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="pr_get_NRSChemistry.html">pr_get_NRSChemistry</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Parameters</span> <span class="op">==</span> <span class="st">"SecchiDepth_m"</span>,</span></span>
<span class="r-in"><span><span class="va">StationCode</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'PHB'</span>, <span class="st">'NSI'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">pr_plot_Enviro</span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="pr_plot_Enviro-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jason D. Everett, Claire H. Davies.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

