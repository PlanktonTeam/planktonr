<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Analysing NRS timeseries â€¢ planktonr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Analysing NRS timeseries">
<meta property="og:description" content="planktonr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">planktonr</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9002</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/planktonr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/CPR_ts.html">CPR timeseries</a>
    </li>
    <li>
      <a href="../articles/NRS_ts.html">Analysing NRS timeseries</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/PlanktonTeam/planktonr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Analysing NRS timeseries</h1>
                        <h4 data-toc-skip class="author">Claire H. Davies and Jason D. Everett</h4>
            
            <h4 data-toc-skip class="date">Tuesday 07 December 2021</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/PlanktonTeam/planktonr/blob/HEAD/vignettes/NRS_ts.Rmd" class="external-link"><code>vignettes/NRS_ts.Rmd</code></a></small>
      <div class="hidden name"><code>NRS_ts.Rmd</code></div>

    </div>

    
    
<div class="section level1">
<h1 id="imos-biological-ocean-observer">IMOS Biological Ocean Observer<a class="anchor" aria-label="anchor" href="#imos-biological-ocean-observer"></a>
</h1>
<p>You can access the online version of IMOS BOO here <a href="https://jaseeverett.shinyapps.io/IMOS_BioOceanObserver/" class="external-link">links</a></p>
<div class="section level2">
<h2 id="load-packages-and-data">Load packages and data<a class="anchor" aria-label="anchor" href="#load-packages-and-data"></a>
</h2>
<p>This vignette demonstrates how to use planktonr to generate timeseries from the IMOS National Reference Station data.</p>
<p>First install the package from github if needed</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"PlanktonTeam/planktonr"</span><span class="op">)</span></code></pre></div>
<p>Then attach the library</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/PlanktonTeam/planktonr" class="external-link">planktonr</a></span><span class="op">)</span></code></pre></div>
<p>Lets look at zooplankton abundance at Yongala and Maria Island, a tropical and a temperate National Reference Station.<br>
First we get the data then we filter it for the desired parameters.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">datNRS_zoo</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pr_get_tsdata.html">pr_get_tsdata</a></span><span class="op">(</span><span class="st">"NRS"</span>, <span class="st">"Z"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="plot-sitemap">Plot Sitemap<a class="anchor" aria-label="anchor" href="#plot-sitemap"></a>
</h2>
<p>We can plot a sitemap to see where the data are.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># pr_plot_NRSmap(datNRS_zoo)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="plot-timeseries">Plot timeseries<a class="anchor" aria-label="anchor" href="#plot-timeseries"></a>
</h2>
<p>Then we can plot the data as a timeseries for Yongala and Maria Island.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">datNRS_zoo</span> <span class="op">&lt;-</span> <span class="va">datNRS_zoo</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">StationName</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Yongala"</span>, <span class="st">"Maria Island"</span><span class="op">)</span>,
         <span class="va">parameters</span> <span class="op">==</span> <span class="st">"ZoopAbund_m3"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html" class="external-link">droplevels</a></span><span class="op">(</span><span class="op">)</span>

<span class="fu"><a href="../reference/pr_plot_tsclimate.html">pr_plot_tsclimate</a></span><span class="op">(</span>df <span class="op">=</span> <span class="va">datNRS_zoo</span>, Survey <span class="op">=</span> <span class="st">"NRS"</span><span class="op">)</span> </code></pre></div>
<p><img src="NRS_ts_files/figure-html/unnamed-chunk-5-1.png" width="576"></p>
<p>We can plot the data on a log_10 scale:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/pr_plot_tsclimate.html">pr_plot_tsclimate</a></span><span class="op">(</span><span class="va">datNRS_zoo</span>, Survey <span class="op">=</span> <span class="st">"NRS"</span>, Scale <span class="op">=</span> <span class="st">"log10"</span><span class="op">)</span></code></pre></div>
<p><img src="NRS_ts_files/figure-html/unnamed-chunk-6-1.png" width="576"></p>
<p>We can also change the colour scale to any scales given by cmocean (<a href="https://cran.r-project.org/web/packages/cmocean/vignettes/cmocean.html" class="external-link uri">https://cran.r-project.org/web/packages/cmocean/vignettes/cmocean.html</a>)</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/pr_plot_tsclimate.html">pr_plot_tsclimate</a></span><span class="op">(</span><span class="va">datNRS_zoo</span>, Survey <span class="op">=</span> <span class="st">"NRS"</span>, Scale <span class="op">=</span> <span class="st">"log10"</span>, pal <span class="op">=</span> <span class="st">"algae"</span><span class="op">)</span></code></pre></div>
<p><img src="NRS_ts_files/figure-html/unnamed-chunk-7-1.png" width="576"></p>
</div>
<div class="section level2">
<h2 id="pipeable-functions">Pipeable functions<a class="anchor" aria-label="anchor" href="#pipeable-functions"></a>
</h2>
<p>The data analysis and plotting functions are pipeable so we can select additional sites on the fly.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/pr_get_tsdata.html">pr_get_tsdata</a></span><span class="op">(</span><span class="st">"NRS"</span>, <span class="st">"Z"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">StationName</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Yongala"</span>, <span class="st">"Port Hacking"</span>, <span class="st">"Maria Island"</span><span class="op">)</span>,
         <span class="va">parameters</span> <span class="op">==</span> <span class="st">"ZoopAbund_m3"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html" class="external-link">droplevels</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/pr_plot_tsclimate.html">pr_plot_tsclimate</a></span><span class="op">(</span>Survey <span class="op">=</span> <span class="st">"NRS"</span>, Scale <span class="op">=</span> <span class="st">"log10"</span>, pal <span class="op">=</span> <span class="st">"algae"</span><span class="op">)</span></code></pre></div>
<p><img src="NRS_ts_files/figure-html/unnamed-chunk-8-1.png" width="576"></p>
</div>
<div class="section level2">
<h2 id="load-and-plot-size-data">Load and plot size data<a class="anchor" aria-label="anchor" href="#load-and-plot-size-data"></a>
</h2>
<p>The zooplankton abundance at Yongala is consistently greater than at Maria Island, although the seasonal cycle at Maria Island is much more pronounced. There may be more zooplankton at Yongala, but is there a difference in copepod size between tropical Yongala and temperate Maria Island.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">datSize</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pr_get_tsdata.html">pr_get_tsdata</a></span><span class="op">(</span><span class="st">"NRS"</span>, <span class="st">"Z"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">StationName</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Yongala"</span>, <span class="st">"Maria Island"</span><span class="op">)</span>,
         <span class="va">parameters</span> <span class="op">==</span> <span class="st">"AvgTotalLengthCopepod_mm"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html" class="external-link">droplevels</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>And then plot the total timeseries</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/pr_plot_tsclimate.html">pr_plot_tsclimate</a></span><span class="op">(</span><span class="va">datSize</span>, Survey <span class="op">=</span> <span class="st">"NRS"</span>, pal <span class="op">=</span> <span class="st">"matter"</span><span class="op">)</span></code></pre></div>
<p><img src="NRS_ts_files/figure-html/unnamed-chunk-10-1.png" width="576"></p>
<p>So whilst Maria Island has less zooplankton abundance the copepods are larger, and potentially more nutritious, as would be expected in a colder environment.</p>
</div>
<div class="section level2">
<h2 id="trends-in-biomass-data">Trends in Biomass Data<a class="anchor" aria-label="anchor" href="#trends-in-biomass-data"></a>
</h2>
<p>Look to see if zooplankton biomass is changing at Maria Island.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">datNRS_zoo</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pr_get_tsdata.html">pr_get_tsdata</a></span><span class="op">(</span><span class="st">"NRS"</span>, <span class="st">"Z"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">parameters</span> <span class="op">==</span> <span class="st">"Biomass_mgm3"</span> <span class="op">&amp;</span> 
           <span class="va">StationName</span> <span class="op">==</span> <span class="st">"Maria Island"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html" class="external-link">droplevels</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/pr_plot_trends.html">pr_plot_trends</a></span><span class="op">(</span><span class="va">datNRS_zoo</span>, trend <span class="op">=</span> <span class="st">"Raw"</span>, survey <span class="op">=</span> <span class="st">"NRS"</span>, method <span class="op">=</span> <span class="st">"lm"</span>, y_trans <span class="op">=</span> <span class="st">"log10"</span><span class="op">)</span></code></pre></div>
<p><img src="NRS_ts_files/figure-html/unnamed-chunk-12-1.png" width="576"></p>
<p>Now lets check the seasonal cycle.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/pr_plot_trends.html">pr_plot_trends</a></span><span class="op">(</span><span class="va">datNRS_zoo</span>, trend <span class="op">=</span> <span class="st">"Month"</span>, survey <span class="op">=</span> <span class="st">"NRS"</span>, method <span class="op">=</span> <span class="st">"loess"</span>, y_trans <span class="op">=</span> <span class="st">"log10"</span><span class="op">)</span></code></pre></div>
<p><img src="NRS_ts_files/figure-html/unnamed-chunk-13-1.png" width="576"></p>
</div>
<div class="section level2">
<h2 id="examine-functional-groups">Examine functional groups<a class="anchor" aria-label="anchor" href="#examine-functional-groups"></a>
</h2>
<p>We can also look at the change in functional groups through time. Firstly by annual averages</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">NRSfgz</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pr_get_fg.html">pr_get_fg</a></span><span class="op">(</span><span class="st">"NRS"</span>, <span class="st">"Z"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">StationName</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Yongala"</span>, <span class="st">"Maria Island"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html" class="external-link">droplevels</a></span><span class="op">(</span><span class="op">)</span>

<span class="fu"><a href="../reference/pr_plot_tsfg.html">pr_plot_tsfg</a></span><span class="op">(</span>df <span class="op">=</span> <span class="va">NRSfgz</span>, Scale <span class="op">=</span> <span class="st">"Actual"</span><span class="op">)</span></code></pre></div>
<p><img src="NRS_ts_files/figure-html/unnamed-chunk-14-1.png" width="576"></p>
<p>And also by Month.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/pr_plot_tsfg.html">pr_plot_tsfg</a></span><span class="op">(</span>df <span class="op">=</span> <span class="va">NRSfgz</span>, trend <span class="op">=</span> <span class="st">"Month"</span><span class="op">)</span></code></pre></div>
<p><img src="NRS_ts_files/figure-html/unnamed-chunk-15-1.png" width="576"></p>
<p>It may be better to analyse the data by proportion.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/pr_plot_tsfg.html">pr_plot_tsfg</a></span><span class="op">(</span>df <span class="op">=</span> <span class="va">NRSfgz</span>, trend <span class="op">=</span> <span class="st">"Month"</span>, Scale <span class="op">=</span> <span class="st">"Percent"</span><span class="op">)</span></code></pre></div>
<p><img src="NRS_ts_files/figure-html/unnamed-chunk-16-1.png" width="576"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jason D. Everett, Claire H. Davies.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
